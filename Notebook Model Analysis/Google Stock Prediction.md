# Stock Price Prediction using LSTM Neural Networks

### 1. **Introduction**

The goal of this project is to predict Googleâ€™s stock price using historical data and a Long Short-Term Memory (LSTM) neural network, a specific type of recurrent neural network (RNN). LSTMs are particularly effective for time series prediction due to their ability to learn long-term dependencies. We use the ```yfinance``` library to fetch historical stock data and train the model on the ```Close``` prices.


```python
pip install yfinance
```

    Requirement already satisfied: yfinance in c:\users\udval\myenv\lib\site-packages (0.2.44)
    Requirement already satisfied: pandas>=1.3.0 in c:\users\udval\myenv\lib\site-packages (from yfinance) (2.2.3)
    Requirement already satisfied: numpy>=1.16.5 in c:\users\udval\myenv\lib\site-packages (from yfinance) (1.26.4)
    Requirement already satisfied: requests>=2.31 in c:\users\udval\myenv\lib\site-packages (from yfinance) (2.31.0)
    Requirement already satisfied: multitasking>=0.0.7 in c:\users\udval\myenv\lib\site-packages (from yfinance) (0.0.11)
    Requirement already satisfied: lxml>=4.9.1 in c:\users\udval\myenv\lib\site-packages (from yfinance) (5.3.0)
    Requirement already satisfied: platformdirs>=2.0.0 in c:\users\udval\myenv\lib\site-packages (from yfinance) (4.2.2)
    Requirement already satisfied: pytz>=2022.5 in c:\users\udval\myenv\lib\site-packages (from yfinance) (2024.2)
    Requirement already satisfied: frozendict>=2.3.4 in c:\users\udval\myenv\lib\site-packages (from yfinance) (2.4.4)
    Requirement already satisfied: peewee>=3.16.2 in c:\users\udval\myenv\lib\site-packages (from yfinance) (3.17.6)
    Requirement already satisfied: beautifulsoup4>=4.11.1 in c:\users\udval\myenv\lib\site-packages (from yfinance) (4.12.3)
    Requirement already satisfied: html5lib>=1.1 in c:\users\udval\myenv\lib\site-packages (from yfinance) (1.1)
    Requirement already satisfied: soupsieve>1.2 in c:\users\udval\myenv\lib\site-packages (from beautifulsoup4>=4.11.1->yfinance) (2.5)
    Requirement already satisfied: six>=1.9 in c:\users\udval\myenv\lib\site-packages (from html5lib>=1.1->yfinance) (1.16.0)
    Requirement already satisfied: webencodings in c:\users\udval\myenv\lib\site-packages (from html5lib>=1.1->yfinance) (0.5.1)
    Requirement already satisfied: python-dateutil>=2.8.2 in c:\users\udval\myenv\lib\site-packages (from pandas>=1.3.0->yfinance) (2.9.0.post0)
    Requirement already satisfied: tzdata>=2022.7 in c:\users\udval\myenv\lib\site-packages (from pandas>=1.3.0->yfinance) (2024.2)
    Requirement already satisfied: charset-normalizer<4,>=2 in c:\users\udval\myenv\lib\site-packages (from requests>=2.31->yfinance) (3.3.2)
    Requirement already satisfied: idna<4,>=2.5 in c:\users\udval\myenv\lib\site-packages (from requests>=2.31->yfinance) (3.7)
    Requirement already satisfied: urllib3<3,>=1.21.1 in c:\users\udval\myenv\lib\site-packages (from requests>=2.31->yfinance) (2.2.1)
    Requirement already satisfied: certifi>=2017.4.17 in c:\users\udval\myenv\lib\site-packages (from requests>=2.31->yfinance) (2024.7.4)
    Note: you may need to restart the kernel to use updated packages.
    

    
    [notice] A new release of pip is available: 24.1.2 -> 24.2
    [notice] To update, run: C:\Users\udval\myenv\Scripts\python.exe -m pip install --upgrade pip
    


```python
pip install numpy pandas scikit-learn tensorflow
```

    Requirement already satisfied: numpy in c:\users\udval\myenv\lib\site-packages (1.26.4)
    Requirement already satisfied: pandas in c:\users\udval\myenv\lib\site-packages (2.2.3)
    Collecting scikit-learn
      Downloading scikit_learn-1.5.2-cp310-cp310-win_amd64.whl.metadata (13 kB)
    Collecting tensorflow
      Downloading tensorflow-2.17.0-cp310-cp310-win_amd64.whl.metadata (3.2 kB)
    Requirement already satisfied: python-dateutil>=2.8.2 in c:\users\udval\myenv\lib\site-packages (from pandas) (2.9.0.post0)
    Requirement already satisfied: pytz>=2020.1 in c:\users\udval\myenv\lib\site-packages (from pandas) (2024.2)
    Requirement already satisfied: tzdata>=2022.7 in c:\users\udval\myenv\lib\site-packages (from pandas) (2024.2)
    Requirement already satisfied: scipy>=1.6.0 in c:\users\udval\myenv\lib\site-packages (from scikit-learn) (1.14.1)
    Collecting joblib>=1.2.0 (from scikit-learn)
      Using cached joblib-1.4.2-py3-none-any.whl.metadata (5.4 kB)
    Collecting threadpoolctl>=3.1.0 (from scikit-learn)
      Using cached threadpoolctl-3.5.0-py3-none-any.whl.metadata (13 kB)
    Collecting tensorflow-intel==2.17.0 (from tensorflow)
      Downloading tensorflow_intel-2.17.0-cp310-cp310-win_amd64.whl.metadata (5.0 kB)
    Collecting absl-py>=1.0.0 (from tensorflow-intel==2.17.0->tensorflow)
      Using cached absl_py-2.1.0-py3-none-any.whl.metadata (2.3 kB)
    Collecting astunparse>=1.6.0 (from tensorflow-intel==2.17.0->tensorflow)
      Using cached astunparse-1.6.3-py2.py3-none-any.whl.metadata (4.4 kB)
    Collecting flatbuffers>=24.3.25 (from tensorflow-intel==2.17.0->tensorflow)
      Using cached flatbuffers-24.3.25-py2.py3-none-any.whl.metadata (850 bytes)
    Collecting gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 (from tensorflow-intel==2.17.0->tensorflow)
      Downloading gast-0.6.0-py3-none-any.whl.metadata (1.3 kB)
    Collecting google-pasta>=0.1.1 (from tensorflow-intel==2.17.0->tensorflow)
      Using cached google_pasta-0.2.0-py3-none-any.whl.metadata (814 bytes)
    Collecting h5py>=3.10.0 (from tensorflow-intel==2.17.0->tensorflow)
      Downloading h5py-3.12.1-cp310-cp310-win_amd64.whl.metadata (2.5 kB)
    Collecting libclang>=13.0.0 (from tensorflow-intel==2.17.0->tensorflow)
      Using cached libclang-18.1.1-py2.py3-none-win_amd64.whl.metadata (5.3 kB)
    Collecting ml-dtypes<0.5.0,>=0.3.1 (from tensorflow-intel==2.17.0->tensorflow)
      Downloading ml_dtypes-0.4.1-cp310-cp310-win_amd64.whl.metadata (20 kB)
    Collecting opt-einsum>=2.3.2 (from tensorflow-intel==2.17.0->tensorflow)
      Downloading opt_einsum-3.4.0-py3-none-any.whl.metadata (6.3 kB)
    Requirement already satisfied: packaging in c:\users\udval\myenv\lib\site-packages (from tensorflow-intel==2.17.0->tensorflow) (23.2)
    Collecting protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 (from tensorflow-intel==2.17.0->tensorflow)
      Downloading protobuf-4.25.5-cp310-abi3-win_amd64.whl.metadata (541 bytes)
    Requirement already satisfied: requests<3,>=2.21.0 in c:\users\udval\myenv\lib\site-packages (from tensorflow-intel==2.17.0->tensorflow) (2.31.0)
    Requirement already satisfied: setuptools in c:\users\udval\myenv\lib\site-packages (from tensorflow-intel==2.17.0->tensorflow) (58.1.0)
    Requirement already satisfied: six>=1.12.0 in c:\users\udval\myenv\lib\site-packages (from tensorflow-intel==2.17.0->tensorflow) (1.16.0)
    Collecting termcolor>=1.1.0 (from tensorflow-intel==2.17.0->tensorflow)
      Using cached termcolor-2.4.0-py3-none-any.whl.metadata (6.1 kB)
    Requirement already satisfied: typing-extensions>=3.6.6 in c:\users\udval\myenv\lib\site-packages (from tensorflow-intel==2.17.0->tensorflow) (4.12.2)
    Collecting wrapt>=1.11.0 (from tensorflow-intel==2.17.0->tensorflow)
      Using cached wrapt-1.16.0-cp310-cp310-win_amd64.whl.metadata (6.8 kB)
    Collecting grpcio<2.0,>=1.24.3 (from tensorflow-intel==2.17.0->tensorflow)
      Downloading grpcio-1.66.2-cp310-cp310-win_amd64.whl.metadata (4.0 kB)
    Collecting tensorboard<2.18,>=2.17 (from tensorflow-intel==2.17.0->tensorflow)
      Downloading tensorboard-2.17.1-py3-none-any.whl.metadata (1.6 kB)
    Collecting keras>=3.2.0 (from tensorflow-intel==2.17.0->tensorflow)
      Downloading keras-3.6.0-py3-none-any.whl.metadata (5.8 kB)
    Collecting tensorflow-io-gcs-filesystem>=0.23.1 (from tensorflow-intel==2.17.0->tensorflow)
      Using cached tensorflow_io_gcs_filesystem-0.31.0-cp310-cp310-win_amd64.whl.metadata (14 kB)
    Collecting wheel<1.0,>=0.23.0 (from astunparse>=1.6.0->tensorflow-intel==2.17.0->tensorflow)
      Using cached wheel-0.44.0-py3-none-any.whl.metadata (2.3 kB)
    Collecting rich (from keras>=3.2.0->tensorflow-intel==2.17.0->tensorflow)
      Downloading rich-13.9.2-py3-none-any.whl.metadata (18 kB)
    Collecting namex (from keras>=3.2.0->tensorflow-intel==2.17.0->tensorflow)
      Downloading namex-0.0.8-py3-none-any.whl.metadata (246 bytes)
    Collecting optree (from keras>=3.2.0->tensorflow-intel==2.17.0->tensorflow)
      Downloading optree-0.13.0-cp310-cp310-win_amd64.whl.metadata (48 kB)
         ---------------------------------------- 0.0/48.7 kB ? eta -:--:--
         ---------------------------------------- 48.7/48.7 kB 1.2 MB/s eta 0:00:00
    Requirement already satisfied: charset-normalizer<4,>=2 in c:\users\udval\myenv\lib\site-packages (from requests<3,>=2.21.0->tensorflow-intel==2.17.0->tensorflow) (3.3.2)
    Requirement already satisfied: idna<4,>=2.5 in c:\users\udval\myenv\lib\site-packages (from requests<3,>=2.21.0->tensorflow-intel==2.17.0->tensorflow) (3.7)
    Requirement already satisfied: urllib3<3,>=1.21.1 in c:\users\udval\myenv\lib\site-packages (from requests<3,>=2.21.0->tensorflow-intel==2.17.0->tensorflow) (2.2.1)
    Requirement already satisfied: certifi>=2017.4.17 in c:\users\udval\myenv\lib\site-packages (from requests<3,>=2.21.0->tensorflow-intel==2.17.0->tensorflow) (2024.7.4)
    Collecting markdown>=2.6.8 (from tensorboard<2.18,>=2.17->tensorflow-intel==2.17.0->tensorflow)
      Downloading Markdown-3.7-py3-none-any.whl.metadata (7.0 kB)
    Collecting tensorboard-data-server<0.8.0,>=0.7.0 (from tensorboard<2.18,>=2.17->tensorflow-intel==2.17.0->tensorflow)
      Downloading tensorboard_data_server-0.7.2-py3-none-any.whl.metadata (1.1 kB)
    Collecting werkzeug>=1.0.1 (from tensorboard<2.18,>=2.17->tensorflow-intel==2.17.0->tensorflow)
      Downloading werkzeug-3.0.4-py3-none-any.whl.metadata (3.7 kB)
    Requirement already satisfied: MarkupSafe>=2.1.1 in c:\users\udval\myenv\lib\site-packages (from werkzeug>=1.0.1->tensorboard<2.18,>=2.17->tensorflow-intel==2.17.0->tensorflow) (2.1.5)
    Collecting markdown-it-py>=2.2.0 (from rich->keras>=3.2.0->tensorflow-intel==2.17.0->tensorflow)
      Using cached markdown_it_py-3.0.0-py3-none-any.whl.metadata (6.9 kB)
    Requirement already satisfied: pygments<3.0.0,>=2.13.0 in c:\users\udval\myenv\lib\site-packages (from rich->keras>=3.2.0->tensorflow-intel==2.17.0->tensorflow) (2.18.0)
    Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich->keras>=3.2.0->tensorflow-intel==2.17.0->tensorflow)
      Using cached mdurl-0.1.2-py3-none-any.whl.metadata (1.6 kB)
    Downloading scikit_learn-1.5.2-cp310-cp310-win_amd64.whl (11.0 MB)
       ---------------------------------------- 0.0/11.0 MB ? eta -:--:--
       - -------------------------------------- 0.3/11.0 MB 6.0 MB/s eta 0:00:02
       ---- ----------------------------------- 1.1/11.0 MB 12.0 MB/s eta 0:00:01
       ------ --------------------------------- 1.8/11.0 MB 12.9 MB/s eta 0:00:01
       ---------- ----------------------------- 2.8/11.0 MB 16.3 MB/s eta 0:00:01
       -------------- ------------------------- 4.0/11.0 MB 17.0 MB/s eta 0:00:01
       ------------------ --------------------- 5.1/11.0 MB 18.1 MB/s eta 0:00:01
       ---------------------- ----------------- 6.1/11.0 MB 18.5 MB/s eta 0:00:01
       ------------------------ --------------- 6.8/11.0 MB 19.0 MB/s eta 0:00:01
       ----------------------------- ---------- 8.0/11.0 MB 19.6 MB/s eta 0:00:01
       -------------------------------- ------- 9.0/11.0 MB 19.2 MB/s eta 0:00:01
       ------------------------------------- -- 10.4/11.0 MB 21.1 MB/s eta 0:00:01
       ---------------------------------------  11.0/11.0 MB 21.9 MB/s eta 0:00:01
       ---------------------------------------- 11.0/11.0 MB 19.8 MB/s eta 0:00:00
    Downloading tensorflow-2.17.0-cp310-cp310-win_amd64.whl (2.0 kB)
    Downloading tensorflow_intel-2.17.0-cp310-cp310-win_amd64.whl (385.0 MB)
       ---------------------------------------- 0.0/385.0 MB ? eta -:--:--
       ---------------------------------------- 1.2/385.0 MB 26.4 MB/s eta 0:00:15
       ---------------------------------------- 2.5/385.0 MB 31.5 MB/s eta 0:00:13
       ---------------------------------------- 3.9/385.0 MB 27.7 MB/s eta 0:00:14
        --------------------------------------- 5.2/385.0 MB 27.5 MB/s eta 0:00:14
        --------------------------------------- 6.5/385.0 MB 27.6 MB/s eta 0:00:14
        --------------------------------------- 7.9/385.0 MB 28.0 MB/s eta 0:00:14
        --------------------------------------- 9.2/385.0 MB 28.0 MB/s eta 0:00:14
       - -------------------------------------- 10.5/385.0 MB 27.3 MB/s eta 0:00:14
       - -------------------------------------- 11.8/385.0 MB 28.4 MB/s eta 0:00:14
       - -------------------------------------- 12.9/385.0 MB 28.4 MB/s eta 0:00:14
       - -------------------------------------- 14.3/385.0 MB 28.5 MB/s eta 0:00:14
       - -------------------------------------- 15.6/385.0 MB 28.5 MB/s eta 0:00:13
       - -------------------------------------- 16.8/385.0 MB 28.5 MB/s eta 0:00:13
       - -------------------------------------- 18.1/385.0 MB 28.5 MB/s eta 0:00:13
       -- ------------------------------------- 19.5/385.0 MB 28.5 MB/s eta 0:00:13
       -- ------------------------------------- 20.8/385.0 MB 28.4 MB/s eta 0:00:13
       -- ------------------------------------- 22.2/385.0 MB 28.4 MB/s eta 0:00:13
       -- ------------------------------------- 23.6/385.0 MB 28.4 MB/s eta 0:00:13
       -- ------------------------------------- 24.9/385.0 MB 28.5 MB/s eta 0:00:13
       -- ------------------------------------- 26.2/385.0 MB 28.5 MB/s eta 0:00:13
       -- ------------------------------------- 27.4/385.0 MB 28.5 MB/s eta 0:00:13
       -- ------------------------------------- 28.8/385.0 MB 28.5 MB/s eta 0:00:13
       --- ------------------------------------ 30.2/385.0 MB 28.5 MB/s eta 0:00:13
       --- ------------------------------------ 31.5/385.0 MB 28.4 MB/s eta 0:00:13
       --- ------------------------------------ 33.0/385.0 MB 28.4 MB/s eta 0:00:13
       --- ------------------------------------ 34.3/385.0 MB 28.4 MB/s eta 0:00:13
       --- ------------------------------------ 35.8/385.0 MB 29.8 MB/s eta 0:00:12
       --- ------------------------------------ 37.1/385.0 MB 29.8 MB/s eta 0:00:12
       ---- ----------------------------------- 38.6/385.0 MB 29.7 MB/s eta 0:00:12
       ---- ----------------------------------- 39.9/385.0 MB 29.7 MB/s eta 0:00:12
       ---- ----------------------------------- 41.2/385.0 MB 29.7 MB/s eta 0:00:12
       ---- ----------------------------------- 42.6/385.0 MB 29.7 MB/s eta 0:00:12
       ---- ----------------------------------- 43.8/385.0 MB 28.4 MB/s eta 0:00:13
       ---- ----------------------------------- 45.1/385.0 MB 28.4 MB/s eta 0:00:12
       ---- ----------------------------------- 46.4/385.0 MB 28.5 MB/s eta 0:00:12
       ---- ----------------------------------- 47.8/385.0 MB 28.5 MB/s eta 0:00:12
       ----- ---------------------------------- 49.3/385.0 MB 28.5 MB/s eta 0:00:12
       ----- ---------------------------------- 50.7/385.0 MB 28.5 MB/s eta 0:00:12
       ----- ---------------------------------- 52.2/385.0 MB 29.7 MB/s eta 0:00:12
       ----- ---------------------------------- 53.6/385.0 MB 29.7 MB/s eta 0:00:12
       ----- ---------------------------------- 55.2/385.0 MB 31.2 MB/s eta 0:00:11
       ----- ---------------------------------- 56.6/385.0 MB 31.1 MB/s eta 0:00:11
       ------ --------------------------------- 58.1/385.0 MB 31.2 MB/s eta 0:00:11
       ------ --------------------------------- 58.9/385.0 MB 29.7 MB/s eta 0:00:11
       ------ --------------------------------- 59.9/385.0 MB 27.3 MB/s eta 0:00:12
       ------ --------------------------------- 61.2/385.0 MB 27.3 MB/s eta 0:00:12
       ------ --------------------------------- 62.6/385.0 MB 28.5 MB/s eta 0:00:12
       ------ --------------------------------- 64.0/385.0 MB 28.5 MB/s eta 0:00:12
       ------ --------------------------------- 65.4/385.0 MB 28.5 MB/s eta 0:00:12
       ------ --------------------------------- 66.8/385.0 MB 28.5 MB/s eta 0:00:12
       ------- -------------------------------- 68.1/385.0 MB 27.3 MB/s eta 0:00:12
       ------- -------------------------------- 69.4/385.0 MB 28.4 MB/s eta 0:00:12
       ------- -------------------------------- 70.7/385.0 MB 29.7 MB/s eta 0:00:11
       ------- -------------------------------- 72.0/385.0 MB 29.8 MB/s eta 0:00:11
       ------- -------------------------------- 73.2/385.0 MB 28.5 MB/s eta 0:00:11
       ------- -------------------------------- 74.6/385.0 MB 28.5 MB/s eta 0:00:11
       ------- -------------------------------- 75.8/385.0 MB 28.5 MB/s eta 0:00:11
       ------- -------------------------------- 76.9/385.0 MB 27.3 MB/s eta 0:00:12
       -------- ------------------------------- 78.3/385.0 MB 27.3 MB/s eta 0:00:12
       -------- ------------------------------- 79.3/385.0 MB 26.2 MB/s eta 0:00:12
       -------- ------------------------------- 80.5/385.0 MB 26.2 MB/s eta 0:00:12
       -------- ------------------------------- 81.8/385.0 MB 26.2 MB/s eta 0:00:12
       -------- ------------------------------- 83.2/385.0 MB 27.3 MB/s eta 0:00:12
       -------- ------------------------------- 84.4/385.0 MB 26.2 MB/s eta 0:00:12
       -------- ------------------------------- 85.5/385.0 MB 27.3 MB/s eta 0:00:11
       --------- ------------------------------ 86.6/385.0 MB 25.2 MB/s eta 0:00:12
       --------- ------------------------------ 88.1/385.0 MB 26.2 MB/s eta 0:00:12
       --------- ------------------------------ 89.4/385.0 MB 27.3 MB/s eta 0:00:11
       --------- ------------------------------ 90.8/385.0 MB 27.3 MB/s eta 0:00:11
       --------- ------------------------------ 92.2/385.0 MB 27.3 MB/s eta 0:00:11
       --------- ------------------------------ 93.4/385.0 MB 27.3 MB/s eta 0:00:11
       --------- ------------------------------ 94.8/385.0 MB 27.3 MB/s eta 0:00:11
       --------- ------------------------------ 96.2/385.0 MB 28.5 MB/s eta 0:00:11
       ---------- ----------------------------- 97.1/385.0 MB 27.3 MB/s eta 0:00:11
       ---------- ----------------------------- 98.5/385.0 MB 27.3 MB/s eta 0:00:11
       ---------- ----------------------------- 99.7/385.0 MB 27.3 MB/s eta 0:00:11
       ---------- ---------------------------- 100.9/385.0 MB 26.2 MB/s eta 0:00:11
       ---------- ---------------------------- 102.3/385.0 MB 27.3 MB/s eta 0:00:11
       ---------- ---------------------------- 103.5/385.0 MB 26.2 MB/s eta 0:00:11
       ---------- ---------------------------- 105.0/385.0 MB 27.3 MB/s eta 0:00:11
       ---------- ---------------------------- 106.2/385.0 MB 26.2 MB/s eta 0:00:11
       ---------- ---------------------------- 107.7/385.0 MB 29.8 MB/s eta 0:00:10
       ---------- ---------------------------- 108.5/385.0 MB 28.4 MB/s eta 0:00:10
       ----------- --------------------------- 108.9/385.0 MB 24.2 MB/s eta 0:00:12
       ----------- --------------------------- 111.3/385.0 MB 27.3 MB/s eta 0:00:11
       ----------- --------------------------- 112.0/385.0 MB 28.5 MB/s eta 0:00:10
       ----------- --------------------------- 114.0/385.0 MB 28.4 MB/s eta 0:00:10
       ----------- --------------------------- 115.3/385.0 MB 28.4 MB/s eta 0:00:10
       ----------- --------------------------- 116.6/385.0 MB 27.3 MB/s eta 0:00:10
       ----------- --------------------------- 117.8/385.0 MB 27.3 MB/s eta 0:00:10
       ------------ -------------------------- 119.2/385.0 MB 32.8 MB/s eta 0:00:09
       ------------ -------------------------- 120.4/385.0 MB 29.7 MB/s eta 0:00:09
       ------------ -------------------------- 121.9/385.0 MB 28.4 MB/s eta 0:00:10
       ------------ -------------------------- 123.2/385.0 MB 29.7 MB/s eta 0:00:09
       ------------ -------------------------- 124.5/385.0 MB 28.4 MB/s eta 0:00:10
       ------------ -------------------------- 125.9/385.0 MB 28.4 MB/s eta 0:00:10
       ------------ -------------------------- 127.3/385.0 MB 28.5 MB/s eta 0:00:10
       ------------- ------------------------- 128.4/385.0 MB 28.5 MB/s eta 0:00:10
       ------------- ------------------------- 129.1/385.0 MB 28.4 MB/s eta 0:00:10
       ------------- ------------------------- 131.1/385.0 MB 27.3 MB/s eta 0:00:10
       ------------- ------------------------- 132.3/385.0 MB 28.5 MB/s eta 0:00:09
       ------------- ------------------------- 133.0/385.0 MB 25.2 MB/s eta 0:00:11
       ------------- ------------------------- 133.8/385.0 MB 23.4 MB/s eta 0:00:11
       ------------- ------------------------- 136.5/385.0 MB 24.2 MB/s eta 0:00:11
       ------------- ------------------------- 137.9/385.0 MB 25.2 MB/s eta 0:00:10
       -------------- ------------------------ 138.9/385.0 MB 24.2 MB/s eta 0:00:11
       -------------- ------------------------ 139.9/385.0 MB 25.1 MB/s eta 0:00:10
       -------------- ------------------------ 141.0/385.0 MB 23.4 MB/s eta 0:00:11
       -------------- ------------------------ 142.2/385.0 MB 22.6 MB/s eta 0:00:11
       -------------- ------------------------ 143.4/385.0 MB 25.2 MB/s eta 0:00:10
       -------------- ------------------------ 144.3/385.0 MB 26.2 MB/s eta 0:00:10
       -------------- ------------------------ 145.5/385.0 MB 26.2 MB/s eta 0:00:10
       -------------- ------------------------ 146.5/385.0 MB 24.2 MB/s eta 0:00:10
       -------------- ------------------------ 147.7/385.0 MB 23.4 MB/s eta 0:00:11
       --------------- ----------------------- 149.0/385.0 MB 24.2 MB/s eta 0:00:10
       --------------- ----------------------- 149.9/385.0 MB 23.4 MB/s eta 0:00:11
       --------------- ----------------------- 150.8/385.0 MB 23.4 MB/s eta 0:00:11
       --------------- ----------------------- 151.9/385.0 MB 23.4 MB/s eta 0:00:10
       --------------- ----------------------- 153.0/385.0 MB 23.4 MB/s eta 0:00:10
       --------------- ----------------------- 153.8/385.0 MB 22.6 MB/s eta 0:00:11
       --------------- ----------------------- 155.0/385.0 MB 22.6 MB/s eta 0:00:11
       --------------- ----------------------- 156.2/385.0 MB 22.6 MB/s eta 0:00:11
       --------------- ----------------------- 157.5/385.0 MB 23.4 MB/s eta 0:00:10
       ---------------- ---------------------- 158.7/385.0 MB 23.4 MB/s eta 0:00:10
       ---------------- ---------------------- 159.9/385.0 MB 24.3 MB/s eta 0:00:10
       ---------------- ---------------------- 161.1/385.0 MB 24.2 MB/s eta 0:00:10
       ---------------- ---------------------- 162.4/385.0 MB 25.2 MB/s eta 0:00:09
       ---------------- ---------------------- 163.5/385.0 MB 25.2 MB/s eta 0:00:09
       ---------------- ---------------------- 164.7/385.0 MB 26.2 MB/s eta 0:00:09
       ---------------- ---------------------- 165.8/385.0 MB 25.2 MB/s eta 0:00:09
       ---------------- ---------------------- 166.9/385.0 MB 26.2 MB/s eta 0:00:09
       ----------------- --------------------- 168.1/385.0 MB 25.1 MB/s eta 0:00:09
       ----------------- --------------------- 169.3/385.0 MB 26.2 MB/s eta 0:00:09
       ----------------- --------------------- 170.4/385.0 MB 25.1 MB/s eta 0:00:09
       ----------------- --------------------- 171.8/385.0 MB 25.2 MB/s eta 0:00:09
       ----------------- --------------------- 172.9/385.0 MB 26.2 MB/s eta 0:00:09
       ----------------- --------------------- 174.2/385.0 MB 26.2 MB/s eta 0:00:09
       ----------------- --------------------- 175.5/385.0 MB 26.2 MB/s eta 0:00:08
       ----------------- --------------------- 176.9/385.0 MB 27.3 MB/s eta 0:00:08
       ------------------ -------------------- 178.0/385.0 MB 27.3 MB/s eta 0:00:08
       ------------------ -------------------- 179.2/385.0 MB 27.3 MB/s eta 0:00:08
       ------------------ -------------------- 180.6/385.0 MB 27.3 MB/s eta 0:00:08
       ------------------ -------------------- 181.8/385.0 MB 27.3 MB/s eta 0:00:08
       ------------------ -------------------- 183.0/385.0 MB 27.3 MB/s eta 0:00:08
       ------------------ -------------------- 183.5/385.0 MB 25.2 MB/s eta 0:00:08
       ------------------ -------------------- 185.1/385.0 MB 26.2 MB/s eta 0:00:08
       ------------------ -------------------- 186.4/385.0 MB 26.2 MB/s eta 0:00:08
       ------------------- ------------------- 187.6/385.0 MB 26.2 MB/s eta 0:00:08
       ------------------- ------------------- 188.9/385.0 MB 26.2 MB/s eta 0:00:08
       ------------------- ------------------- 190.2/385.0 MB 26.2 MB/s eta 0:00:08
       ------------------- ------------------- 191.3/385.0 MB 25.1 MB/s eta 0:00:08
       ------------------- ------------------- 192.5/385.0 MB 25.2 MB/s eta 0:00:08
       ------------------- ------------------- 193.8/385.0 MB 28.5 MB/s eta 0:00:07
       ------------------- ------------------- 195.1/385.0 MB 27.3 MB/s eta 0:00:07
       ------------------- ------------------- 196.2/385.0 MB 27.3 MB/s eta 0:00:07
       ------------------- ------------------- 197.4/385.0 MB 26.2 MB/s eta 0:00:08
       -------------------- ------------------ 198.4/385.0 MB 25.2 MB/s eta 0:00:08
       -------------------- ------------------ 199.5/385.0 MB 25.1 MB/s eta 0:00:08
       -------------------- ------------------ 200.5/385.0 MB 24.2 MB/s eta 0:00:08
       -------------------- ------------------ 201.6/385.0 MB 24.3 MB/s eta 0:00:08
       -------------------- ------------------ 202.6/385.0 MB 24.2 MB/s eta 0:00:08
       -------------------- ------------------ 203.3/385.0 MB 23.4 MB/s eta 0:00:08
       -------------------- ------------------ 203.9/385.0 MB 22.6 MB/s eta 0:00:09
       -------------------- ------------------ 203.9/385.0 MB 22.6 MB/s eta 0:00:09
       -------------------- ------------------ 204.7/385.0 MB 19.3 MB/s eta 0:00:10
       -------------------- ------------------ 205.2/385.0 MB 18.7 MB/s eta 0:00:10
       -------------------- ------------------ 205.9/385.0 MB 17.2 MB/s eta 0:00:11
       -------------------- ------------------ 206.6/385.0 MB 17.3 MB/s eta 0:00:11
       -------------------- ------------------ 207.2/385.0 MB 16.4 MB/s eta 0:00:11
       --------------------- ----------------- 207.8/385.0 MB 16.0 MB/s eta 0:00:12
       --------------------- ----------------- 208.4/385.0 MB 15.2 MB/s eta 0:00:12
       --------------------- ----------------- 209.1/385.0 MB 14.9 MB/s eta 0:00:12
       --------------------- ----------------- 209.7/385.0 MB 14.6 MB/s eta 0:00:13
       --------------------- ----------------- 210.3/385.0 MB 14.2 MB/s eta 0:00:13
       --------------------- ----------------- 210.9/385.0 MB 13.6 MB/s eta 0:00:13
       --------------------- ----------------- 211.6/385.0 MB 13.4 MB/s eta 0:00:13
       --------------------- ----------------- 212.2/385.0 MB 13.4 MB/s eta 0:00:13
       --------------------- ----------------- 212.8/385.0 MB 12.8 MB/s eta 0:00:14
       --------------------- ----------------- 213.5/385.0 MB 12.6 MB/s eta 0:00:14
       --------------------- ----------------- 214.1/385.0 MB 12.8 MB/s eta 0:00:14
       --------------------- ----------------- 214.8/385.0 MB 13.1 MB/s eta 0:00:13
       --------------------- ----------------- 215.4/385.0 MB 13.6 MB/s eta 0:00:13
       --------------------- ----------------- 216.0/385.0 MB 13.6 MB/s eta 0:00:13
       --------------------- ----------------- 216.6/385.0 MB 13.6 MB/s eta 0:00:13
       ---------------------- ---------------- 217.2/385.0 MB 13.4 MB/s eta 0:00:13
       ---------------------- ---------------- 217.9/385.0 MB 13.6 MB/s eta 0:00:13
       ---------------------- ---------------- 218.6/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 219.3/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 219.9/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 220.6/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 221.3/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 222.0/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 222.7/385.0 MB 14.2 MB/s eta 0:00:12
       ---------------------- ---------------- 223.2/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 223.8/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 224.3/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 225.0/385.0 MB 13.9 MB/s eta 0:00:12
       ---------------------- ---------------- 225.5/385.0 MB 13.6 MB/s eta 0:00:12
       ---------------------- ---------------- 226.0/385.0 MB 13.4 MB/s eta 0:00:12
       ---------------------- ---------------- 226.4/385.0 MB 13.1 MB/s eta 0:00:13
       ---------------------- ---------------- 226.9/385.0 MB 13.1 MB/s eta 0:00:13
       ----------------------- --------------- 227.4/385.0 MB 12.8 MB/s eta 0:00:13
       ----------------------- --------------- 227.9/385.0 MB 12.6 MB/s eta 0:00:13
       ----------------------- --------------- 228.4/385.0 MB 12.6 MB/s eta 0:00:13
       ----------------------- --------------- 228.9/385.0 MB 12.6 MB/s eta 0:00:13
       ----------------------- --------------- 229.3/385.0 MB 11.9 MB/s eta 0:00:14
       ----------------------- --------------- 230.0/385.0 MB 12.1 MB/s eta 0:00:13
       ----------------------- --------------- 230.3/385.0 MB 11.9 MB/s eta 0:00:13
       ----------------------- --------------- 230.9/385.0 MB 11.9 MB/s eta 0:00:13
       ----------------------- --------------- 231.4/385.0 MB 11.7 MB/s eta 0:00:14
       ----------------------- --------------- 231.8/385.0 MB 11.3 MB/s eta 0:00:14
       ----------------------- --------------- 232.2/385.0 MB 11.3 MB/s eta 0:00:14
       ----------------------- --------------- 233.0/385.0 MB 11.3 MB/s eta 0:00:14
       ----------------------- --------------- 233.5/385.0 MB 11.3 MB/s eta 0:00:14
       ----------------------- --------------- 234.1/385.0 MB 11.3 MB/s eta 0:00:14
       ----------------------- --------------- 234.6/385.0 MB 11.3 MB/s eta 0:00:14
       ----------------------- --------------- 235.2/385.0 MB 11.1 MB/s eta 0:00:14
       ----------------------- --------------- 235.9/385.0 MB 11.3 MB/s eta 0:00:14
       ----------------------- --------------- 236.5/385.0 MB 11.3 MB/s eta 0:00:14
       ------------------------ -------------- 237.1/385.0 MB 11.7 MB/s eta 0:00:13
       ------------------------ -------------- 237.6/385.0 MB 11.7 MB/s eta 0:00:13
       ------------------------ -------------- 238.3/385.0 MB 11.9 MB/s eta 0:00:13
       ------------------------ -------------- 238.9/385.0 MB 11.9 MB/s eta 0:00:13
       ------------------------ -------------- 239.5/385.0 MB 11.9 MB/s eta 0:00:13
       ------------------------ -------------- 240.1/385.0 MB 12.1 MB/s eta 0:00:12
       ------------------------ -------------- 240.7/385.0 MB 12.4 MB/s eta 0:00:12
       ------------------------ -------------- 241.3/385.0 MB 12.4 MB/s eta 0:00:12
       ------------------------ -------------- 242.0/385.0 MB 12.8 MB/s eta 0:00:12
       ------------------------ -------------- 242.6/385.0 MB 13.1 MB/s eta 0:00:11
       ------------------------ -------------- 242.8/385.0 MB 12.8 MB/s eta 0:00:12
       ------------------------ -------------- 243.9/385.0 MB 13.1 MB/s eta 0:00:11
       ------------------------ -------------- 244.5/385.0 MB 13.1 MB/s eta 0:00:11
       ------------------------ -------------- 245.2/385.0 MB 13.4 MB/s eta 0:00:11
       ------------------------ -------------- 245.7/385.0 MB 13.4 MB/s eta 0:00:11
       ------------------------ -------------- 246.4/385.0 MB 13.4 MB/s eta 0:00:11
       ------------------------- ------------- 247.0/385.0 MB 13.4 MB/s eta 0:00:11
       ------------------------- ------------- 247.7/385.0 MB 13.4 MB/s eta 0:00:11
       ------------------------- ------------- 248.3/385.0 MB 13.4 MB/s eta 0:00:11
       ------------------------- ------------- 248.9/385.0 MB 13.4 MB/s eta 0:00:11
       ------------------------- ------------- 249.6/385.0 MB 13.6 MB/s eta 0:00:10
       ------------------------- ------------- 250.2/385.0 MB 13.9 MB/s eta 0:00:10
       ------------------------- ------------- 250.9/385.0 MB 13.9 MB/s eta 0:00:10
       ------------------------- ------------- 251.6/385.0 MB 13.9 MB/s eta 0:00:10
       ------------------------- ------------- 252.3/385.0 MB 13.9 MB/s eta 0:00:10
       ------------------------- ------------- 252.9/385.0 MB 13.9 MB/s eta 0:00:10
       ------------------------- ------------- 253.5/385.0 MB 14.6 MB/s eta 0:00:10
       ------------------------- ------------- 254.2/385.0 MB 13.9 MB/s eta 0:00:10
       ------------------------- ------------- 254.8/385.0 MB 13.9 MB/s eta 0:00:10
       ------------------------- ------------- 255.4/385.0 MB 13.9 MB/s eta 0:00:10
       ------------------------- ------------- 256.1/385.0 MB 13.9 MB/s eta 0:00:10
       -------------------------- ------------ 256.7/385.0 MB 13.9 MB/s eta 0:00:10
       -------------------------- ------------ 257.4/385.0 MB 14.2 MB/s eta 0:00:09
       -------------------------- ------------ 257.9/385.0 MB 13.9 MB/s eta 0:00:10
       -------------------------- ------------ 258.5/385.0 MB 13.9 MB/s eta 0:00:10
       -------------------------- ------------ 259.2/385.0 MB 13.9 MB/s eta 0:00:10
       -------------------------- ------------ 259.9/385.0 MB 13.9 MB/s eta 0:00:09
       -------------------------- ------------ 260.4/385.0 MB 13.6 MB/s eta 0:00:10
       -------------------------- ------------ 260.9/385.0 MB 13.4 MB/s eta 0:00:10
       -------------------------- ------------ 261.3/385.0 MB 13.1 MB/s eta 0:00:10
       -------------------------- ------------ 261.9/385.0 MB 13.1 MB/s eta 0:00:10
       -------------------------- ------------ 262.6/385.0 MB 13.1 MB/s eta 0:00:10
       -------------------------- ------------ 263.2/385.0 MB 13.1 MB/s eta 0:00:10
       -------------------------- ------------ 263.5/385.0 MB 13.4 MB/s eta 0:00:10
       -------------------------- ------------ 264.1/385.0 MB 12.6 MB/s eta 0:00:10
       -------------------------- ------------ 264.6/385.0 MB 12.4 MB/s eta 0:00:10
       -------------------------- ------------ 265.0/385.0 MB 12.1 MB/s eta 0:00:10
       -------------------------- ------------ 265.6/385.0 MB 12.1 MB/s eta 0:00:10
       -------------------------- ------------ 266.1/385.0 MB 12.1 MB/s eta 0:00:10
       --------------------------- ----------- 266.8/385.0 MB 11.9 MB/s eta 0:00:10
       --------------------------- ----------- 267.3/385.0 MB 11.9 MB/s eta 0:00:10
       --------------------------- ----------- 267.8/385.0 MB 12.1 MB/s eta 0:00:10
       --------------------------- ----------- 268.4/385.0 MB 11.7 MB/s eta 0:00:10
       --------------------------- ----------- 268.9/385.0 MB 11.9 MB/s eta 0:00:10
       --------------------------- ----------- 269.6/385.0 MB 11.9 MB/s eta 0:00:10
       --------------------------- ----------- 270.2/385.0 MB 11.9 MB/s eta 0:00:10
       --------------------------- ----------- 270.9/385.0 MB 12.1 MB/s eta 0:00:10
       --------------------------- ----------- 271.2/385.0 MB 12.1 MB/s eta 0:00:10
       --------------------------- ----------- 271.6/385.0 MB 11.9 MB/s eta 0:00:10
       --------------------------- ----------- 272.1/385.0 MB 11.7 MB/s eta 0:00:10
       --------------------------- ----------- 272.6/385.0 MB 11.5 MB/s eta 0:00:10
       --------------------------- ----------- 273.3/385.0 MB 11.7 MB/s eta 0:00:10
       --------------------------- ----------- 274.1/385.0 MB 12.1 MB/s eta 0:00:10
       --------------------------- ----------- 274.6/385.0 MB 12.4 MB/s eta 0:00:09
       --------------------------- ----------- 275.7/385.0 MB 12.9 MB/s eta 0:00:09
       ---------------------------- ---------- 276.4/385.0 MB 13.1 MB/s eta 0:00:09
       ---------------------------- ---------- 277.2/385.0 MB 13.4 MB/s eta 0:00:09
       ---------------------------- ---------- 278.0/385.0 MB 13.6 MB/s eta 0:00:08
       ---------------------------- ---------- 278.8/385.0 MB 14.2 MB/s eta 0:00:08
       ---------------------------- ---------- 279.6/385.0 MB 14.2 MB/s eta 0:00:08
       ---------------------------- ---------- 280.2/385.0 MB 14.6 MB/s eta 0:00:08
       ---------------------------- ---------- 281.0/385.0 MB 14.5 MB/s eta 0:00:08
       ---------------------------- ---------- 281.7/385.0 MB 15.2 MB/s eta 0:00:07
       ---------------------------- ---------- 282.5/385.0 MB 16.0 MB/s eta 0:00:07
       ---------------------------- ---------- 283.3/385.0 MB 16.4 MB/s eta 0:00:07
       ---------------------------- ---------- 284.0/385.0 MB 16.4 MB/s eta 0:00:07
       ---------------------------- ---------- 284.7/385.0 MB 16.4 MB/s eta 0:00:07
       ---------------------------- ---------- 285.6/385.0 MB 16.4 MB/s eta 0:00:07
       ----------------------------- --------- 286.4/385.0 MB 16.4 MB/s eta 0:00:07
       ----------------------------- --------- 287.2/385.0 MB 16.4 MB/s eta 0:00:06
       ----------------------------- --------- 288.0/385.0 MB 16.4 MB/s eta 0:00:06
       ----------------------------- --------- 288.7/385.0 MB 16.4 MB/s eta 0:00:06
       ----------------------------- --------- 289.5/385.0 MB 16.4 MB/s eta 0:00:06
       ----------------------------- --------- 290.4/385.0 MB 16.4 MB/s eta 0:00:06
       ----------------------------- --------- 291.3/385.0 MB 16.8 MB/s eta 0:00:06
       ----------------------------- --------- 292.1/385.0 MB 17.2 MB/s eta 0:00:06
       ----------------------------- --------- 293.0/385.0 MB 17.2 MB/s eta 0:00:06
       ----------------------------- --------- 293.9/385.0 MB 17.2 MB/s eta 0:00:06
       ----------------------------- --------- 294.8/385.0 MB 17.7 MB/s eta 0:00:06
       ----------------------------- --------- 295.6/385.0 MB 17.7 MB/s eta 0:00:06
       ------------------------------ -------- 296.4/385.0 MB 17.7 MB/s eta 0:00:06
       ------------------------------ -------- 297.3/385.0 MB 18.2 MB/s eta 0:00:05
       ------------------------------ -------- 298.1/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------ -------- 299.0/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------ -------- 299.8/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------ -------- 300.7/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------ -------- 301.6/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------ -------- 302.3/385.0 MB 18.2 MB/s eta 0:00:05
       ------------------------------ -------- 303.1/385.0 MB 18.2 MB/s eta 0:00:05
       ------------------------------ -------- 304.0/385.0 MB 18.2 MB/s eta 0:00:05
       ------------------------------ -------- 304.9/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------ -------- 305.9/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------- ------- 306.7/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------- ------- 307.5/385.0 MB 18.2 MB/s eta 0:00:05
       ------------------------------- ------- 308.4/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------- ------- 309.3/385.0 MB 18.7 MB/s eta 0:00:05
       ------------------------------- ------- 310.0/385.0 MB 18.2 MB/s eta 0:00:05
       ------------------------------- ------- 310.8/385.0 MB 18.2 MB/s eta 0:00:05
       ------------------------------- ------- 311.7/385.0 MB 18.2 MB/s eta 0:00:05
       ------------------------------- ------- 312.6/385.0 MB 18.7 MB/s eta 0:00:04
       ------------------------------- ------- 313.6/385.0 MB 18.7 MB/s eta 0:00:04
       ------------------------------- ------- 314.4/385.0 MB 18.7 MB/s eta 0:00:04
       ------------------------------- ------- 315.3/385.0 MB 18.7 MB/s eta 0:00:04
       -------------------------------- ------ 316.1/385.0 MB 18.2 MB/s eta 0:00:04
       -------------------------------- ------ 317.0/385.0 MB 18.7 MB/s eta 0:00:04
       -------------------------------- ------ 317.9/385.0 MB 18.2 MB/s eta 0:00:04
       -------------------------------- ------ 318.9/385.0 MB 18.7 MB/s eta 0:00:04
       -------------------------------- ------ 319.8/385.0 MB 18.7 MB/s eta 0:00:04
       -------------------------------- ------ 320.6/385.0 MB 19.3 MB/s eta 0:00:04
       -------------------------------- ------ 321.5/385.0 MB 19.3 MB/s eta 0:00:04
       -------------------------------- ------ 322.5/385.0 MB 19.3 MB/s eta 0:00:04
       -------------------------------- ------ 323.4/385.0 MB 19.2 MB/s eta 0:00:04
       -------------------------------- ------ 324.3/385.0 MB 19.2 MB/s eta 0:00:04
       -------------------------------- ------ 325.0/385.0 MB 18.7 MB/s eta 0:00:04
       --------------------------------- ----- 326.0/385.0 MB 19.3 MB/s eta 0:00:04
       --------------------------------- ----- 327.0/385.0 MB 19.3 MB/s eta 0:00:04
       --------------------------------- ----- 327.9/385.0 MB 19.9 MB/s eta 0:00:03
       --------------------------------- ----- 328.7/385.0 MB 20.5 MB/s eta 0:00:03
       --------------------------------- ----- 329.7/385.0 MB 19.9 MB/s eta 0:00:03
       --------------------------------- ----- 330.1/385.0 MB 19.3 MB/s eta 0:00:03
       --------------------------------- ----- 331.0/385.0 MB 19.3 MB/s eta 0:00:03
       --------------------------------- ----- 332.0/385.0 MB 18.7 MB/s eta 0:00:03
       --------------------------------- ----- 332.9/385.0 MB 18.7 MB/s eta 0:00:03
       --------------------------------- ----- 333.9/385.0 MB 18.7 MB/s eta 0:00:03
       --------------------------------- ----- 334.9/385.0 MB 18.7 MB/s eta 0:00:03
       ---------------------------------- ---- 335.9/385.0 MB 19.9 MB/s eta 0:00:03
       ---------------------------------- ---- 336.8/385.0 MB 18.7 MB/s eta 0:00:03
       ---------------------------------- ---- 337.8/385.0 MB 19.3 MB/s eta 0:00:03
       ---------------------------------- ---- 338.8/385.0 MB 19.2 MB/s eta 0:00:03
       ---------------------------------- ---- 339.7/385.0 MB 19.8 MB/s eta 0:00:03
       ---------------------------------- ---- 340.5/385.0 MB 20.5 MB/s eta 0:00:03
       ---------------------------------- ---- 341.5/385.0 MB 20.5 MB/s eta 0:00:03
       ---------------------------------- ---- 342.5/385.0 MB 20.5 MB/s eta 0:00:03
       ---------------------------------- ---- 343.4/385.0 MB 20.5 MB/s eta 0:00:03
       ---------------------------------- ---- 344.3/385.0 MB 20.5 MB/s eta 0:00:02
       ---------------------------------- ---- 345.3/385.0 MB 20.5 MB/s eta 0:00:02
       ----------------------------------- --- 346.3/385.0 MB 20.5 MB/s eta 0:00:02
       ----------------------------------- --- 347.3/385.0 MB 20.5 MB/s eta 0:00:02
       ----------------------------------- --- 348.2/385.0 MB 20.5 MB/s eta 0:00:02
       ----------------------------------- --- 349.2/385.0 MB 20.5 MB/s eta 0:00:02
       ----------------------------------- --- 350.2/385.0 MB 21.1 MB/s eta 0:00:02
       ----------------------------------- --- 351.2/385.0 MB 21.1 MB/s eta 0:00:02
       ----------------------------------- --- 352.2/385.0 MB 21.1 MB/s eta 0:00:02
       ----------------------------------- --- 353.0/385.0 MB 20.5 MB/s eta 0:00:02
       ----------------------------------- --- 354.0/385.0 MB 21.1 MB/s eta 0:00:02
       ----------------------------------- --- 354.8/385.0 MB 21.1 MB/s eta 0:00:02
       ------------------------------------ -- 355.6/385.0 MB 20.5 MB/s eta 0:00:02
       ------------------------------------ -- 356.5/385.0 MB 19.8 MB/s eta 0:00:02
       ------------------------------------ -- 357.5/385.0 MB 19.9 MB/s eta 0:00:02
       ------------------------------------ -- 358.5/385.0 MB 19.9 MB/s eta 0:00:02
       ------------------------------------ -- 359.2/385.0 MB 19.9 MB/s eta 0:00:02
       ------------------------------------ -- 360.3/385.0 MB 19.8 MB/s eta 0:00:02
       ------------------------------------ -- 361.1/385.0 MB 19.3 MB/s eta 0:00:02
       ------------------------------------ -- 362.1/385.0 MB 19.3 MB/s eta 0:00:02
       ------------------------------------ -- 363.1/385.0 MB 19.2 MB/s eta 0:00:02
       ------------------------------------ -- 364.2/385.0 MB 19.8 MB/s eta 0:00:02
       ------------------------------------ -- 365.1/385.0 MB 20.5 MB/s eta 0:00:01
       ------------------------------------- - 366.1/385.0 MB 20.5 MB/s eta 0:00:01
       ------------------------------------- - 367.0/385.0 MB 20.5 MB/s eta 0:00:01
       ------------------------------------- - 368.0/385.0 MB 20.5 MB/s eta 0:00:01
       ------------------------------------- - 368.9/385.0 MB 20.5 MB/s eta 0:00:01
       ------------------------------------- - 369.8/385.0 MB 20.5 MB/s eta 0:00:01
       ------------------------------------- - 370.8/385.0 MB 20.5 MB/s eta 0:00:01
       ------------------------------------- - 371.8/385.0 MB 20.5 MB/s eta 0:00:01
       ------------------------------------- - 372.9/385.0 MB 21.1 MB/s eta 0:00:01
       ------------------------------------- - 374.0/385.0 MB 21.1 MB/s eta 0:00:01
       ------------------------------------- - 374.9/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  375.9/385.0 MB 21.1 MB/s eta 0:00:01
       --------------------------------------  377.0/385.0 MB 21.1 MB/s eta 0:00:01
       --------------------------------------  378.1/385.0 MB 21.8 MB/s eta 0:00:01
       --------------------------------------  379.1/385.0 MB 21.8 MB/s eta 0:00:01
       --------------------------------------  380.3/385.0 MB 23.4 MB/s eta 0:00:01
       --------------------------------------  381.1/385.0 MB 21.9 MB/s eta 0:00:01
       --------------------------------------  381.8/385.0 MB 21.1 MB/s eta 0:00:01
       --------------------------------------  382.9/385.0 MB 21.1 MB/s eta 0:00:01
       --------------------------------------  383.9/385.0 MB 21.9 MB/s eta 0:00:01
       --------------------------------------  384.7/385.0 MB 21.1 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       --------------------------------------  385.0/385.0 MB 20.5 MB/s eta 0:00:01
       ---------------------------------------- 385.0/385.0 MB 7.0 MB/s eta 0:00:00
    Using cached joblib-1.4.2-py3-none-any.whl (301 kB)
    Using cached threadpoolctl-3.5.0-py3-none-any.whl (18 kB)
    Using cached absl_py-2.1.0-py3-none-any.whl (133 kB)
    Using cached astunparse-1.6.3-py2.py3-none-any.whl (12 kB)
    Using cached flatbuffers-24.3.25-py2.py3-none-any.whl (26 kB)
    Downloading gast-0.6.0-py3-none-any.whl (21 kB)
    Using cached google_pasta-0.2.0-py3-none-any.whl (57 kB)
    Downloading grpcio-1.66.2-cp310-cp310-win_amd64.whl (4.3 MB)
       ---------------------------------------- 0.0/4.3 MB ? eta -:--:--
       ---------- ----------------------------- 1.1/4.3 MB 35.0 MB/s eta 0:00:01
       ------------------- -------------------- 2.1/4.3 MB 26.4 MB/s eta 0:00:01
       ----------------------------- ---------- 3.2/4.3 MB 25.1 MB/s eta 0:00:01
       ------------------------------------- -- 4.1/4.3 MB 23.7 MB/s eta 0:00:01
       ---------------------------------------- 4.3/4.3 MB 21.1 MB/s eta 0:00:00
    Downloading h5py-3.12.1-cp310-cp310-win_amd64.whl (3.0 MB)
       ---------------------------------------- 0.0/3.0 MB ? eta -:--:--
       -------- ------------------------------- 0.6/3.0 MB 39.0 MB/s eta 0:00:01
       ---------------------- ----------------- 1.6/3.0 MB 21.0 MB/s eta 0:00:01
       ------------------------------- -------- 2.4/3.0 MB 19.0 MB/s eta 0:00:01
       ---------------------------------------  3.0/3.0 MB 19.1 MB/s eta 0:00:01
       ---------------------------------------- 3.0/3.0 MB 15.9 MB/s eta 0:00:00
    Downloading keras-3.6.0-py3-none-any.whl (1.2 MB)
       ---------------------------------------- 0.0/1.2 MB ? eta -:--:--
       -------------------------------- ------- 1.0/1.2 MB 29.8 MB/s eta 0:00:01
       ---------------------------------------- 1.2/1.2 MB 18.7 MB/s eta 0:00:00
    Using cached libclang-18.1.1-py2.py3-none-win_amd64.whl (26.4 MB)
    Downloading ml_dtypes-0.4.1-cp310-cp310-win_amd64.whl (126 kB)
       ---------------------------------------- 0.0/126.6 kB ? eta -:--:--
       ---------------------------------------- 126.6/126.6 kB 7.3 MB/s eta 0:00:00
    Downloading opt_einsum-3.4.0-py3-none-any.whl (71 kB)
       ---------------------------------------- 0.0/71.9 kB ? eta -:--:--
       ---------------------------------------- 71.9/71.9 kB 3.9 MB/s eta 0:00:00
    Downloading protobuf-4.25.5-cp310-abi3-win_amd64.whl (413 kB)
       ---------------------------------------- 0.0/413.4 kB ? eta -:--:--
       --------------------------------------- 413.4/413.4 kB 26.9 MB/s eta 0:00:00
    Downloading tensorboard-2.17.1-py3-none-any.whl (5.5 MB)
       ---------------------------------------- 0.0/5.5 MB ? eta -:--:--
       ------- -------------------------------- 1.0/5.5 MB 32.3 MB/s eta 0:00:01
       -------------- ------------------------- 2.0/5.5 MB 25.5 MB/s eta 0:00:01
       ---------------------- ----------------- 3.0/5.5 MB 24.2 MB/s eta 0:00:01
       ----------------------------- ---------- 4.0/5.5 MB 23.3 MB/s eta 0:00:01
       ------------------------------------- -- 5.2/5.5 MB 23.5 MB/s eta 0:00:01
       ---------------------------------------  5.5/5.5 MB 23.4 MB/s eta 0:00:01
       ---------------------------------------- 5.5/5.5 MB 19.5 MB/s eta 0:00:00
    Using cached tensorflow_io_gcs_filesystem-0.31.0-cp310-cp310-win_amd64.whl (1.5 MB)
    Using cached termcolor-2.4.0-py3-none-any.whl (7.7 kB)
    Using cached wrapt-1.16.0-cp310-cp310-win_amd64.whl (37 kB)
    Downloading Markdown-3.7-py3-none-any.whl (106 kB)
       ---------------------------------------- 0.0/106.3 kB ? eta -:--:--
       ---------------------------------------- 106.3/106.3 kB 6.4 MB/s eta 0:00:00
    Downloading tensorboard_data_server-0.7.2-py3-none-any.whl (2.4 kB)
    Downloading werkzeug-3.0.4-py3-none-any.whl (227 kB)
       ---------------------------------------- 0.0/227.6 kB ? eta -:--:--
       ---------------------------------------- 227.6/227.6 kB 7.0 MB/s eta 0:00:00
    Using cached wheel-0.44.0-py3-none-any.whl (67 kB)
    Downloading namex-0.0.8-py3-none-any.whl (5.8 kB)
    Downloading optree-0.13.0-cp310-cp310-win_amd64.whl (274 kB)
       ---------------------------------------- 0.0/274.7 kB ? eta -:--:--
       --------------------------------------- 274.7/274.7 kB 16.5 MB/s eta 0:00:00
    Downloading rich-13.9.2-py3-none-any.whl (242 kB)
       ---------------------------------------- 0.0/242.1 kB ? eta -:--:--
       --------------------------------------- 242.1/242.1 kB 14.5 MB/s eta 0:00:00
    Using cached markdown_it_py-3.0.0-py3-none-any.whl (87 kB)
    Using cached mdurl-0.1.2-py3-none-any.whl (10.0 kB)
    Installing collected packages: namex, libclang, flatbuffers, wrapt, wheel, werkzeug, threadpoolctl, termcolor, tensorflow-io-gcs-filesystem, tensorboard-data-server, protobuf, optree, opt-einsum, ml-dtypes, mdurl, markdown, joblib, h5py, grpcio, google-pasta, gast, absl-py, tensorboard, scikit-learn, markdown-it-py, astunparse, rich, keras, tensorflow-intel, tensorflow
    Successfully installed absl-py-2.1.0 astunparse-1.6.3 flatbuffers-24.3.25 gast-0.6.0 google-pasta-0.2.0 grpcio-1.66.2 h5py-3.12.1 joblib-1.4.2 keras-3.6.0 libclang-18.1.1 markdown-3.7 markdown-it-py-3.0.0 mdurl-0.1.2 ml-dtypes-0.4.1 namex-0.0.8 opt-einsum-3.4.0 optree-0.13.0 protobuf-4.25.5 rich-13.9.2 scikit-learn-1.5.2 tensorboard-2.17.1 tensorboard-data-server-0.7.2 tensorflow-2.17.0 tensorflow-intel-2.17.0 tensorflow-io-gcs-filesystem-0.31.0 termcolor-2.4.0 threadpoolctl-3.5.0 werkzeug-3.0.4 wheel-0.44.0 wrapt-1.16.0
    Note: you may need to restart the kernel to use updated packages.
    

    
    [notice] A new release of pip is available: 24.1.2 -> 24.2
    [notice] To update, run: C:\Users\udval\myenv\Scripts\python.exe -m pip install --upgrade pip
    


```python
pip install matplotlib
```

    Collecting matplotlib
      Downloading matplotlib-3.9.2-cp310-cp310-win_amd64.whl.metadata (11 kB)
    Collecting contourpy>=1.0.1 (from matplotlib)
      Downloading contourpy-1.3.0-cp310-cp310-win_amd64.whl.metadata (5.4 kB)
    Collecting cycler>=0.10 (from matplotlib)
      Using cached cycler-0.12.1-py3-none-any.whl.metadata (3.8 kB)
    Collecting fonttools>=4.22.0 (from matplotlib)
      Downloading fonttools-4.54.1-cp310-cp310-win_amd64.whl.metadata (167 kB)
         ---------------------------------------- 0.0/167.0 kB ? eta -:--:--
         -------------------------------- ----- 143.4/167.0 kB 4.3 MB/s eta 0:00:01
         -------------------------------------- 167.0/167.0 kB 2.5 MB/s eta 0:00:00
    Collecting kiwisolver>=1.3.1 (from matplotlib)
      Downloading kiwisolver-1.4.7-cp310-cp310-win_amd64.whl.metadata (6.4 kB)
    Requirement already satisfied: numpy>=1.23 in c:\users\udval\myenv\lib\site-packages (from matplotlib) (1.26.4)
    Requirement already satisfied: packaging>=20.0 in c:\users\udval\myenv\lib\site-packages (from matplotlib) (23.2)
    Collecting pillow>=8 (from matplotlib)
      Using cached pillow-10.4.0-cp310-cp310-win_amd64.whl.metadata (9.3 kB)
    Collecting pyparsing>=2.3.1 (from matplotlib)
      Downloading pyparsing-3.1.4-py3-none-any.whl.metadata (5.1 kB)
    Requirement already satisfied: python-dateutil>=2.7 in c:\users\udval\myenv\lib\site-packages (from matplotlib) (2.9.0.post0)
    Requirement already satisfied: six>=1.5 in c:\users\udval\myenv\lib\site-packages (from python-dateutil>=2.7->matplotlib) (1.16.0)
    Downloading matplotlib-3.9.2-cp310-cp310-win_amd64.whl (7.8 MB)
       ---------------------------------------- 0.0/7.8 MB ? eta -:--:--
       -- ------------------------------------- 0.4/7.8 MB 8.7 MB/s eta 0:00:01
       ------ --------------------------------- 1.2/7.8 MB 15.5 MB/s eta 0:00:01
       ------------ --------------------------- 2.5/7.8 MB 17.5 MB/s eta 0:00:01
       ------------------ --------------------- 3.5/7.8 MB 18.8 MB/s eta 0:00:01
       ------------------------ --------------- 4.8/7.8 MB 21.8 MB/s eta 0:00:01
       ----------------------------- ---------- 5.8/7.8 MB 20.4 MB/s eta 0:00:01
       ------------------------------------- -- 7.2/7.8 MB 22.1 MB/s eta 0:00:01
       ---------------------------------------- 7.8/7.8 MB 21.8 MB/s eta 0:00:00
    Downloading contourpy-1.3.0-cp310-cp310-win_amd64.whl (216 kB)
       ---------------------------------------- 0.0/216.0 kB ? eta -:--:--
       ---------------------------------------- 216.0/216.0 kB 6.4 MB/s eta 0:00:00
    Using cached cycler-0.12.1-py3-none-any.whl (8.3 kB)
    Downloading fonttools-4.54.1-cp310-cp310-win_amd64.whl (2.2 MB)
       ---------------------------------------- 0.0/2.2 MB ? eta -:--:--
       --------------------- ------------------ 1.2/2.2 MB 36.8 MB/s eta 0:00:01
       ---------------------------------------  2.2/2.2 MB 34.8 MB/s eta 0:00:01
       ---------------------------------------- 2.2/2.2 MB 23.4 MB/s eta 0:00:00
    Downloading kiwisolver-1.4.7-cp310-cp310-win_amd64.whl (55 kB)
       ---------------------------------------- 0.0/55.9 kB ? eta -:--:--
       ---------------------------------------- 55.9/55.9 kB 2.9 MB/s eta 0:00:00
    Using cached pillow-10.4.0-cp310-cp310-win_amd64.whl (2.6 MB)
    Downloading pyparsing-3.1.4-py3-none-any.whl (104 kB)
       ---------------------------------------- 0.0/104.1 kB ? eta -:--:--
       ---------------------------------------- 104.1/104.1 kB 6.3 MB/s eta 0:00:00
    Installing collected packages: pyparsing, pillow, kiwisolver, fonttools, cycler, contourpy, matplotlib
    Successfully installed contourpy-1.3.0 cycler-0.12.1 fonttools-4.54.1 kiwisolver-1.4.7 matplotlib-3.9.2 pillow-10.4.0 pyparsing-3.1.4
    Note: you may need to restart the kernel to use updated packages.
    

    
    [notice] A new release of pip is available: 24.1.2 -> 24.2
    [notice] To update, run: C:\Users\udval\myenv\Scripts\python.exe -m pip install --upgrade pip
    


```python
#Importing Libraries and Data
import yfinance as yf
import pandas as pd
import numpy as np
import tensorflow as tf
from sklearn.preprocessing import MinMaxScaler
from datetime import datetime
import matplotlib.pyplot as plt
%matplotlib inline
```

### 2. Data Collection

To begin, we download Google stock data using the ```yfinance``` API for a specified time range.


```python
end = datetime.now()
start = datetime(end.year-20, end.month, end.day)
```


```python
#Get Google stock information
stock = "GOOG"
# Download stock data from Yahoo Finance, focusing only on 'Close' prices
google_data = yf.download(stock, start=start, end=end)[['Close']]
```

    [*********************100%***********************]  1 of 1 completed
    


```python
# Inspecting the first few rows
google_data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Close</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2004-10-05</th>
      <td>3.446332</td>
    </tr>
    <tr>
      <th>2004-10-06</th>
      <td>3.414203</td>
    </tr>
    <tr>
      <th>2004-10-07</th>
      <td>3.458287</td>
    </tr>
    <tr>
      <th>2004-10-08</th>
      <td>3.430392</td>
    </tr>
    <tr>
      <th>2004-10-11</th>
      <td>3.368873</td>
    </tr>
  </tbody>
</table>
</div>



- For this project, we are only focusing on ```Close``` price as it reflects the stock's final orice for the day, making it a good indicator for long-term trends (*Other columns like 'Open', 'High', and 'Low' are typically more volatile and not necessary for this simplified model.*).

### 3. Data Exploration and Visualization


```python
google_data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Close</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5035.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>46.644890</td>
    </tr>
    <tr>
      <th>std</th>
      <td>44.638960</td>
    </tr>
    <tr>
      <th>min</th>
      <td>3.368873</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>13.148964</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>27.440163</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>61.561249</td>
    </tr>
    <tr>
      <th>max</th>
      <td>192.660004</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Check for missing values
google_data.isna().sum()
```




    Close    0
    dtype: int64



#### Plotting the Closing Prices


```python
plt.figure(figsize=(10, 6))
plt.plot(google_data.index, google_data['Close'], color='blue', label='Google Close Price')
plt.title("Google Close Price Over Time")
plt.xlabel("Date")
plt.ylabel("Close Price")
plt.legend()
plt.show()
```


    
![png](output_15_0.png)
    


This plot allows us to observe the stock price trend over time. From the graph, we can observe significant fluctuations in Google's stock prices, including upward and downward trends. These trends will form the basis for our predictions.

### 4. Calculate Moving Average (MA)

We calculate the Moving Average (e.g., 250-day MA) to smooth out daily fluctuations and identify the trend. A 250-day moving average represents a longer-term trend, giving us insight into overall stock movement over a year (MA_250 helps understand yearly trends). 


```python
# Calculate 250-day Moving Average (MA) to smooth the data
google_data['MA_250'] = google_data['Close'].rolling(window=250).mean()

# Plot the Close price and the Moving Average (MA)
plt.figure(figsize=(10, 6))
plt.plot(google_data.index, google_data['Close'], color='blue', label='Google Close Price')
plt.plot(google_data.index, google_data['MA_250'], color='red', label='250-Day MA')
plt.title("Google Close Price and 250-Day Moving Average")
plt.xlabel("Date")
plt.ylabel("Price")
plt.legend()
plt.show()
```

    C:\Users\udval\AppData\Local\Temp\ipykernel_16256\4026983063.py:2: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      google_data['MA_250'] = google_data['Close'].rolling(window=250).mean()
    


    
![png](output_18_1.png)
    


The 250-day Moving Average helps smooth the fluctuations and provides a clearer view of the stock's longer-term trend. We use this to identify/understand whether the stock is in an uptrend or downtrend.

From the plot, we see that the 250-day MA line is less volatile compared to the 'Close' price, indicating that it captures the stock's overall movement over a longer period.

### 5. Training and Test Splitting
We'll split the data into training and testing sets to train the model on historical data and test it on unseen data.


```python
# Split data into training (80%) and testing (20%)
train_size = int(len(google_data) * 0.8)
train_data = google_data[:train_size]
test_data = google_data[train_size:]

train_data.shape, test_data.shape
```




    ((4028, 2), (1007, 2))



We split the data into training and testing sets, where 80% of the data is used to train the model, and the remaining 20% is for testing how well the model generalizes to unseen data.

### 6. Scaling the Data


```python
# Scale the Close price to be between 0 and 1 for better performance in training
# Scale only the 'Close' column, ensuring it's a 2D array
scaler = MinMaxScaler(feature_range=(0, 1))
scaled_train_data = scaler.fit_transform(train_data[['Close']])
scaled_test_data = scaler.transform(test_data[['Close']])
```

By scaling the ```Close``` prices, it ensures that the model treats all input values equally without one dominating because of larger numerical ranges. Without scaling, larger numbers can disproportionately influence the model, leading to suboptimal predictions. Normalization makes training faster and more efficient.

### 7. Create Sequences for LSTM Model


```python
def create_sequences(data, window_size):
    X, y = [], []
    for i in range(window_size, len(data)):
        X.append(data[i-window_size:i, 0])
        y.append(data[i, 0])
    return np.array(X), np.array(y)

# Set the window size (e.g., 60 days of historical data)
window_size = 60

# Create sequences
X_train, y_train = create_sequences(scaled_train_data, window_size)
X_test, y_test = create_sequences(scaled_test_data, window_size)
```

LSTM models require sequential data. We create sequences of 60 days of historical data (i.e., 60 previous days of stock prices) to predict the stock price on the 61st day.

### 8. Build and Train the LSTM Model


```python
from keras.models import Sequential
from keras.layers import Dense, LSTM
```


```python
# Build the LSTM model
model = Sequential()
model.add(LSTM(50, return_sequences=True, input_shape=(X_train.shape[1], 1)))
model.add(Dropout(0.2))
model.add(LSTM(50, return_sequences=False))
model.add(Dropout(0.2))
model.add(Dense(1))

# Compile the model
model.compile(optimizer='adam', loss='mean_squared_error')

# Train the model
model.fit(X_train, y_train, epochs=20, batch_size=32)
```

    Epoch 1/20
    

    C:\Users\udval\myenv\lib\site-packages\keras\src\layers\rnn\rnn.py:204: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
      super().__init__(**kwargs)
    

    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m6s[0m 29ms/step - loss: 0.0188
    Epoch 2/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 0.0013
    Epoch 3/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 34ms/step - loss: 0.0012
    Epoch 4/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 31ms/step - loss: 0.0013
    Epoch 5/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 30ms/step - loss: 0.0011
    Epoch 6/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 0.0011
    Epoch 7/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 9.0286e-04
    Epoch 8/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 9.1685e-04
    Epoch 9/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 9.8492e-04
    Epoch 10/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 30ms/step - loss: 7.4287e-04
    Epoch 11/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 9.0009e-04
    Epoch 12/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 7.6156e-04
    Epoch 13/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 7.7353e-04
    Epoch 14/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 7.1846e-04
    Epoch 15/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 7.5454e-04
    Epoch 16/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 7.0280e-04
    Epoch 17/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 6.0010e-04
    Epoch 18/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 31ms/step - loss: 7.1104e-04
    Epoch 19/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 32ms/step - loss: 5.3806e-04
    Epoch 20/20
    [1m124/124[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m4s[0m 29ms/step - loss: 5.9242e-04
    




    <keras.src.callbacks.history.History at 0x1d04834c610>



- The LSTM (Long Short-Term Memory) network is ideal for time series prediction tasks like stock prices due to its ability to remember long-term dependencies.
- We use two LSTM layers with Dropout to prevent overfitting and a Dense output layer to predict the stock price.

### 9. Making Predictions 


```python
# Make predictions on the test set
predicted_stock_price = model.predict(X_test)

# Inverse the scaling
predicted_stock_price = scaler.inverse_transform(predicted_stock_price)

# Reshape test data to compare with predictions
actual_stock_price = scaler.inverse_transform(scaled_test_data[window_size:])
```

    [1m30/30[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 19ms/step
    


```python
# Plot actual vs predicted prices
plt.figure(figsize=(10, 6))
plt.plot(google_data.index[train_size + window_size:], actual_stock_price, color='blue', label='Actual Google Stock Price')
plt.plot(google_data.index[train_size + window_size:], predicted_stock_price, color='red', label='Predicted Google Stock Price')
plt.title('Google Stock Price Prediction')
plt.xlabel('Date')
plt.ylabel('Stock Price')
plt.legend()
plt.show()
```


    
![png](output_35_0.png)
    


From the plot, we observe the 'Close' price trend for Google's stock over the given time period. The ```Close``` price represents the final trading price of the stock for each day. 


```python
model.save("Latest_stock_price_model.keras")
```


```python

```
